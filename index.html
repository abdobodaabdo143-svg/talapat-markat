<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ§Ø¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</title>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --success: #06d6a0;
            --warning: #ffd166;
            --danger: #ef476f;
            --dark: #2b2d42;
            --light: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Cairo', Tahoma, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .stat-value {
            font-size: 2.8rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: #666;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-title {
            font-size: 1.6rem;
            color: var(--dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
            font-size: 1.1rem;
        }
        
        input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
        }
        
        .btn-secondary {
            background: #f1f5f9;
            color: #555;
            border: 2px solid #ddd;
        }
        
        .btn-secondary:hover {
            background: #e2e8f0;
        }
        
        .result-card {
            display: none;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .progress-container {
            width: 200px;
            height: 200px;
            margin-bottom: 25px;
            position: relative;
        }
        
        .progress-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(#4361ee 0deg, #eee 0deg);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .progress-circle::before {
            content: '';
            position: absolute;
            width: 160px;
            height: 160px;
            background: white;
            border-radius: 50%;
        }
        
        .progress-value {
            position: relative;
            z-index: 1;
            font-size: 2.5rem;
            font-weight: 800;
            color: #4361ee;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            width: 100%;
            margin-top: 20px;
        }
        
        .result-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .result-label {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 8px;
        }
        
        .result-number {
            font-size: 1.6rem;
            font-weight: 700;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        th {
            background: #f8f9fa;
            padding: 20px;
            font-weight: 600;
            color: #555;
            border-bottom: 2px solid #eee;
        }
        
        td {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .action-btn {
            padding: 8px 15px;
            border-radius: 8px;
            border: none;
            background: #f1f5f9;
            color: #555;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .action-btn:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            color: white;
            font-size: 0.95rem;
        }
        
        .export-btn {
            background: #06d6a0;
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            background: #05c490;
            transform: translateY(-3px);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 30px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.success {
            background: linear-gradient(135deg, #06d6a0 0%, #05c490 100%);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #ef476f 0%, #e63946 100%);
        }
        
        .notification.info {
            background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
        }
        
        /* ØªØ®ØµÙŠØµ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            border-radius: 10px;
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù„Ù„Ù‡ÙˆØ§ØªÙ */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            th, td {
                padding: 15px 10px;
                font-size: 0.9rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> Ù…ØªØ§Ø¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h1>
            <p class="subtitle">ØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¦Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ ÙˆØ­Ù‚Ù‚ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© - Ø¨Ø¯ÙˆÙ† ØªØ¹Ù‚ÙŠØ¯Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalDays">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙŠØ§Ù…</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalOrders">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalProfit">0 Ø¬.Ù…</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgCompletion">0%</div>
                <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-calculator"></i>
                    Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…ÙŠ
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-bullseye"></i> Ø§Ù„ØªØ§Ø±Ø¬Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª)</label>
                    <input type="number" id="target" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©" min="1">
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-check-circle"></i> Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª Ø§Ù„Ù…Ù†ÙØ°Ø©</label>
                    <input type="number" id="done" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª Ø§Ù„Ù…Ù†ÙØ°Ø©" min="0">
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ù…ÙƒØ³Ø¨ Ù…Ù† Ø§Ù„Ø£ÙˆØ±Ø¯Ø± Ø§Ù„ÙˆØ§Ø­Ø¯ (Ø¬Ù†ÙŠØ©)</label>
                    <input type="number" id="profitPerOrder" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…ÙƒØ³Ø¨ Ù…Ù† ÙƒÙ„ Ø£ÙˆØ±Ø¯Ø±" min="1">
                </div>
                
                <div class="btn-group">
                    <button class="btn-primary" onclick="calculate()">
                        <i class="fas fa-calculator"></i>
                        Ø§Ø­Ø³Ø¨ ÙˆØ§Ø­ÙØ¸
                    </button>
                    <button class="btn-secondary" onclick="clearInputs()">
                        <i class="fas fa-eraser"></i>
                        Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
                    </button>
                </div>
            </div>
            
            <div class="card result-card" id="resultCard">
                <div class="progress-container">
                    <div class="progress-circle" id="progressCircle">
                        <div class="progress-value" id="progressValue">0%</div>
                    </div>
                </div>
                
                <h3 id="resultTitle">Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙŠÙˆÙ…</h3>
                
                <div class="result-grid">
                    <div class="result-item">
                        <div class="result-label">Ø§Ù„ØªØ§Ø±ÙŠØ®</div>
                        <div class="result-number" id="resultDate"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
                        <div class="result-number" id="resultDone"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Ø§Ù„Ù†Ø³Ø¨Ø©</div>
                        <div class="result-number" id="resultPercent"></div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Ø§Ù„Ù…ÙƒØ³Ø¨</div>
                        <div class="result-number" id="resultProfit"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">
                <i class="fas fa-history"></i>
                Ø³Ø¬Ù„ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ
            </div>
            
            <div id="historyContent">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                            <th>Ø§Ù„Ù‡Ø¯Ù</th>
                            <th>Ø§Ù„Ù…Ù†ÙØ°</th>
                            <th>Ø§Ù„Ù†Ø³Ø¨Ø©</th>
                            <th>Ø§Ù„Ù…ÙƒØ³Ø¨</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="history">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                    </tbody>
                </table>
                
                <div id="emptyHistory" class="empty-state">
                    <i class="fas fa-clipboard-list"></i>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</h3>
                    <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„ Ù„ØªØ±Ù‰ Ø³Ø¬Ù„Ùƒ Ù‡Ù†Ø§</p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2024 Ù…ØªØ§Ø¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ ÙÙ‚Ø·</p>
            <button class="export-btn" onclick="exportData()">
                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù JSON
            </button>
            <button class="export-btn" onclick="importData()" style="background: #4361ee; margin-left: 10px;">
                <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
            <button class="export-btn" onclick="clearAllData()" style="background: #ef476f; margin-left: 10px;">
                <i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            </button>
        </div>
    </div>

    <script>
        // ===========================================
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        // ===========================================
        let ordersHistory = [];
        
        // ===========================================
        // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        // ===========================================
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderHistory();
            updateSummary();
        });
        
        // ===========================================
        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        // ===========================================
        function loadData() {
            try {
                const saved = localStorage.getItem('ordersHistory');
                if (saved) {
                    ordersHistory = JSON.parse(saved);
                    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ù„Ù‰ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                    ordersHistory.forEach(item => {
                        if (item.dateKey && !item.timestamp) {
                            item.timestamp = new Date(item.dateKey).getTime();
                        }
                    });
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                ordersHistory = [];
            }
        }
        
        function saveData() {
            try {
                localStorage.setItem('ordersHistory', JSON.stringify(ordersHistory));
                return true;
            } catch (error) {
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                return false;
            }
        }
        
        // ===========================================
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        // ===========================================
        function calculate() {
            const target = Number(document.getElementById('target').value);
            const done = Number(document.getElementById('done').value);
            const profitPerOrder = Number(document.getElementById('profitPerOrder').value);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
            if (!target || target <= 0) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±Ø¬Øª ØµØ­ÙŠØ­', 'error');
                document.getElementById('target').focus();
                return;
            }
            
            if (done < 0) {
                showNotification('Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª Ø§Ù„Ù…Ù†ÙØ°Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ØµÙØ± Ø£Ùˆ Ø£ÙƒØ«Ø±', 'error');
                document.getElementById('done').focus();
                return;
            }
            
            if (!profitPerOrder || profitPerOrder <= 0) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙƒØ³Ø¨ ØµØ­ÙŠØ­', 'error');
                document.getElementById('profitPerOrder').focus();
                return;
            }
            
            // Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
            const percent = Math.min(((done / target) * 100), 100).toFixed(2);
            const profit = done * profitPerOrder;
            const date = new Date().toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            
            const dateKey = new Date().toLocaleDateString('en-CA');
            const timestamp = new Date().getTime();
            
            const data = {
                date,
                dateKey,
                target,
                done,
                percent: parseFloat(percent),
                profit,
                profitPerOrder,
                timestamp
            };
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯ Ù„Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…
            const existingIndex = ordersHistory.findIndex(item => item.dateKey === dateKey);
            
            if (existingIndex !== -1) {
                if (confirm('Ù‡Ù†Ø§Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ø§Ù„ÙØ¹Ù„. Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ø¯ÙŠØ«Ù‡ØŸ')) {
                    ordersHistory[existingIndex] = data;
                } else {
                    return;
                }
            } else {
                ordersHistory.push(data);
            }
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (saveData()) {
                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                showResult(data);
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                renderHistory();
                updateSummary();
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }
        
        function showResult(data) {
            const resultCard = document.getElementById('resultCard');
            const progressCircle = document.getElementById('progressCircle');
            const progressValue = document.getElementById('progressValue');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            resultCard.style.display = 'flex';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…
            document.getElementById('resultDate').textContent = data.date;
            document.getElementById('resultDone').textContent = `${data.done} / ${data.target}`;
            document.getElementById('resultPercent').textContent = `${data.percent}%`;
            document.getElementById('resultProfit').textContent = `${data.profit.toLocaleString()} Ø¬.Ù…`;
            
            // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
            const percent = data.percent;
            progressCircle.style.background = `conic-gradient(#4361ee ${percent}%, #eee ${percent}% 100%)`;
            progressValue.textContent = `${percent}%`;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ø£Ø¯Ø§Ø¡
            const resultTitle = document.getElementById('resultTitle');
            if (percent >= 100) {
                resultTitle.textContent = 'ğŸ‰ Ø¥Ù†Ø¬Ø§Ø² Ø±Ø§Ø¦Ø¹! ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ù‡Ø¯Ù';
                resultTitle.style.color = '#06d6a0';
            } else if (percent >= 80) {
                resultTitle.textContent = 'âœ¨ Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† Ø§Ù„Ù‡Ø¯Ù';
                resultTitle.style.color = '#4361ee';
            } else if (percent >= 50) {
                resultTitle.textContent = 'ğŸ‘ Ø¬ÙŠØ¯ØŒ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø¯Ù…';
                resultTitle.style.color = '#ffd166';
            } else {
                resultTitle.textContent = 'ğŸ’ª ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ø°Ù„ Ø¬Ù‡Ø¯ Ø£ÙƒØ«Ø±';
                resultTitle.style.color = '#ef476f';
            }
        }
        
        function renderHistory() {
            const tbody = document.getElementById('history');
            const emptyState = document.getElementById('emptyHistory');
            
            if (ordersHistory.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ù…Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø¯Ù…
            ordersHistory.sort((a, b) => b.timestamp - a.timestamp);
            
            emptyState.style.display = 'none';
            
            let tbodyHTML = '';
            
            ordersHistory.forEach((item, index) => {
                const status = item.percent >= 100 ? 'Ù…ÙƒØªÙ…Ù„' : 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°';
                const statusClass = item.percent >= 100 ? 'success' : 'pending';
                
                tbodyHTML += `
                    <tr>
                        <td>${item.date}</td>
                        <td><strong>${item.target}</strong></td>
                        <td><strong>${item.done}</strong></td>
                        <td><strong>${item.percent}%</strong></td>
                        <td><strong>${item.profit.toLocaleString()} Ø¬.Ù…</strong></td>
                        <td>
                            <div class="actions">
                                <button class="action-btn" onclick="editEntry(${index})" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn" onclick="deleteEntry(${index})" title="Ø­Ø°Ù">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = tbodyHTML;
        }
        
        function updateSummary() {
            if (ordersHistory.length === 0) {
                document.getElementById('totalDays').textContent = '0';
                document.getElementById('totalOrders').textContent = '0';
                document.getElementById('totalProfit').textContent = '0 Ø¬.Ù…';
                document.getElementById('avgCompletion').textContent = '0%';
                return;
            }
            
            const totalDays = ordersHistory.length;
            const totalOrders = ordersHistory.reduce((sum, item) => sum + item.done, 0);
            const totalProfit = ordersHistory.reduce((sum, item) => sum + item.profit, 0);
            const avgCompletion = ordersHistory.reduce((sum, item) => sum + parseFloat(item.percent), 0) / totalDays;
            
            // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù„Ù„Ø£Ø±Ù‚Ø§Ù…
            animateCounter('totalDays', 0, totalDays, 1000);
            animateCounter('totalOrders', 0, totalOrders, 1000);
            animateCounter('totalProfit', 0, totalProfit, 1000);
            animateCounter('avgCompletion', 0, avgCompletion, 1000, true);
        }
        
        function animateCounter(elementId, start, end, duration, isPercent = false) {
            const element = document.getElementById(elementId);
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                let currentValue;
                if (isPercent) {
                    currentValue = start + (end - start) * progress;
                    element.textContent = `${currentValue.toFixed(1)}%`;
                } else if (elementId === 'totalProfit') {
                    currentValue = Math.floor(start + (end - start) * progress);
                    element.textContent = `${currentValue.toLocaleString()} Ø¬.Ù…`;
                } else {
                    currentValue = Math.floor(start + (end - start) * progress);
                    element.textContent = currentValue;
                }
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }
        
        // ===========================================
        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        // ===========================================
        function editEntry(index) {
            const entry = ordersHistory[index];
            
            if (!entry) return;
            
            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            document.getElementById('target').value = entry.target;
            document.getElementById('done').value = entry.done;
            document.getElementById('profitPerOrder').value = entry.profitPerOrder;
            
            // Ø­Ø°Ù Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…
            ordersHistory.splice(index, 1);
            saveData();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
            renderHistory();
            updateSummary();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. Ù‚Ù… Ø¨Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ø­Ø³Ø¨ ÙˆØ§Ø­ÙØ¸"', 'info');
        }
        
        function deleteEntry(index) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')) return;
            
            ordersHistory.splice(index, 1);
            saveData();
            renderHistory();
            updateSummary();
            document.getElementById('resultCard').style.display = 'none';
            
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function clearInputs() {
            document.getElementById('target').value = '';
            document.getElementById('done').value = '';
            document.getElementById('profitPerOrder').value = '';
            document.getElementById('resultCard').style.display = 'none';
            
            // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ù‡Ø¯Ù
            document.getElementById('target').focus();
        }
        
        function clearAllData() {
            if (!confirm('âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø³ÙŠØ­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) return;
            
            ordersHistory = [];
            saveData();
            renderHistory();
            updateSummary();
            document.getElementById('resultCard').style.display = 'none';
            
            showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        // ===========================================
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
        // ===========================================
        function exportData() {
            if (ordersHistory.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
                return;
            }
            
            const dataStr = JSON.stringify(ordersHistory, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileName = `Ø·Ù„Ø¨Ø§Øª_${new Date().toLocaleDateString('ar-EG')}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileName);
            linkElement.click();
            
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (!Array.isArray(importedData)) {
                            showNotification('Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª.', 'error');
                            return;
                        }
                        
                        if (confirm(`Ø³ØªÙ‚ÙˆÙ… Ø¨Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${importedData.length} Ø³Ø¬Ù„. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ`)) {
                            ordersHistory = importedData;
                            saveData();
                            renderHistory();
                            updateSummary();
                            showNotification('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                        }
                    } catch (err) {
                        showNotification('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© ØªÙ†Ø³ÙŠÙ‚ JSON.', 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // ===========================================
        // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
        // ===========================================
        function showNotification(message, type) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
            const oldNotifications = document.querySelectorAll('.notification');
            oldNotifications.forEach(notification => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 
                                 type === 'error' ? 'exclamation-circle' : 
                                 'info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // ===========================================
        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        // ===========================================
        function saveSettings() {
            const settings = {
                lastTarget: document.getElementById('target').value,
                lastProfitPerOrder: document.getElementById('profitPerOrder').value
            };
            localStorage.setItem('ordersSettings', JSON.stringify(settings));
        }
        
        function loadSettings() {
            try {
                const saved = localStorage.getItem('ordersSettings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    document.getElementById('target').value = settings.lastTarget || '';
                    document.getElementById('profitPerOrder').value = settings.lastProfitPerOrder || '';
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:', error);
            }
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        document.addEventListener('DOMContentLoaded', loadSettings);
        
        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
        document.getElementById('target').addEventListener('input', saveSettings);
        document.getElementById('profitPerOrder').addEventListener('input', saveSettings);
    </script>
</body>
</html>
